<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monthly Planner Template</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/themes.css">
    <link rel="stylesheet" href="../css/print.css">
    <style>
        @page {
            size: A4;
            margin: 0.5in;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            font-size: 10pt;
            line-height: 1.4;
        }

        .page {
            width: 100%;
            height: 100vh;
            min-height: 800px;
            padding: 20px;
            background-color: white;
            position: relative;
            page-break-after: always;
        }

        .page-header {
            text-align: center;
            margin-bottom: 20px;
            font-size: 18pt;
            font-weight: bold;
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .month-calendar {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .month-calendar th {
            background-color: var(--secondary-color);
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .month-calendar td {
            height: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            vertical-align: top;
            position: relative;
        }

        .day-number {
            font-weight: bold;
            font-size: 12pt;
            position: absolute;
            top: 5px;
            right: 5px;
        }

        .day-content {
            padding-top: 25px;
            height: calc(100% - 25px);
        }

        .notes-section {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }

        .notes-header {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .notes-area {
            border: 1px solid #ddd;
            height: 200px;
            padding: 10px;
            background-image: linear-gradient(to bottom, transparent 19px, #eee 19px, #eee 20px, transparent 20px);
            background-size: 100% 20px;
            background-attachment: local;
        }

        .page-footer {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            text-align: center;
            font-size: 8pt;
            color: #666;
            border-top: 1px solid #ccc;
            padding-top: 10px;
        }

        @media print {
            .page {
                height: auto;
                min-height: 100vh;
                page-break-after: always;
            }
        }
    </style>
</head>
<body class="planner-monthly">
    <!-- Page 1 -->
    <div class="page">
        <div class="page-header" id="header-text">Monthly Planner - January 2024</div>

        <table class="month-calendar">
            <thead>
                <tr>
                    <th>Sunday</th>
                    <th>Monday</th>
                    <th>Tuesday</th>
                    <th>Wednesday</th>
                    <th>Thursday</th>
                    <th>Friday</th>
                    <th>Saturday</th>
                </tr>
            </thead>
            <tbody id="calendar-body">
                <!-- Calendar will be generated by JavaScript -->
            </tbody>
        </table>

        <div class="notes-section">
            <div class="notes-header">Monthly Notes & Goals</div>
            <div class="notes-area"></div>
        </div>

        <div class="page-footer" id="footer-text">January 2024</div>
    </div>

    <!-- Additional pages will be generated by JavaScript -->
    <div id="additional-pages"></div>

    <script>
        // Generate calendar for current month
        function generateCalendar(year, month) {
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(firstDay.getDate() - firstDay.getDay());

            const calendarBody = document.getElementById('calendar-body');
            calendarBody.innerHTML = '';

            let currentDate = new Date(startDate);
            let weekRow = document.createElement('tr');

            for (let i = 0; i < 42; i++) { // 6 weeks * 7 days
                if (i > 0 && i % 7 === 0) {
                    calendarBody.appendChild(weekRow);
                    weekRow = document.createElement('tr');
                }

                const dayCell = document.createElement('td');
                if (currentDate.getMonth() === month) {
                    dayCell.innerHTML = `
                        <div class="day-number">${currentDate.getDate()}</div>
                        <div class="day-content"></div>
                    `;
                } else {
                    dayCell.classList.add('other-month');
                }

                weekRow.appendChild(dayCell);
                currentDate.setDate(currentDate.getDate() + 1);
            }

            calendarBody.appendChild(weekRow);
        }

        // Generate additional pages based on user settings
        const urlParams = new URLSearchParams(window.location.search);
        const pageCount = parseInt(urlParams.get('pages')) || 12; // 12 months
        const theme = urlParams.get('theme') || 'minimalist';
        const primaryColor = urlParams.get('primary') || '#2c3e50';
        const secondaryColor = urlParams.get('secondary') || '#3498db';
        const headerText = urlParams.get('header') || 'Monthly Planner';
        const footerText = urlParams.get('footer') || '{month} {year}';

        document.body.classList.add(`theme-${theme}`);
        document.documentElement.style.setProperty('--primary-color', primaryColor);
        document.documentElement.style.setProperty('--secondary-color', secondaryColor);

        const headerElement = document.getElementById('header-text');
        const footerElement = document.getElementById('footer-text');

        // Generate first month (current month)
        const now = new Date();
        const currentMonth = now.getMonth();
        const currentYear = now.getFullYear();

        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                           'July', 'August', 'September', 'October', 'November', 'December'];

        headerElement.textContent = `${headerText} - ${monthNames[currentMonth]} ${currentYear}`;
        footerElement.textContent = footerText.replace('{month}', monthNames[currentMonth]).replace('{year}', currentYear);

        generateCalendar(currentYear, currentMonth);

        const additionalPagesContainer = document.getElementById('additional-pages');

        for (let i = 1; i < pageCount; i++) {
            const targetMonth = (currentMonth + i) % 12;
            const targetYear = currentYear + Math.floor((currentMonth + i) / 12);

            const pageDiv = document.createElement('div');
            pageDiv.className = 'page';
            pageDiv.innerHTML = `
                <div class="page-header">${headerText} - ${monthNames[targetMonth]} ${targetYear}</div>
                <table class="month-calendar">
                    <thead>
                        <tr>
                            <th>Sunday</th>
                            <th>Monday</th>
                            <th>Tuesday</th>
                            <th>Wednesday</th>
                            <th>Thursday</th>
                            <th>Friday</th>
                            <th>Saturday</th>
                        </tr>
                    </thead>
                    <tbody id="calendar-body-${i}"></tbody>
                </table>
                <div class="notes-section">
                    <div class="notes-header">Monthly Notes & Goals</div>
                    <div class="notes-area"></div>
                </div>
                <div class="page-footer">${footerText.replace('{month}', monthNames[targetMonth]).replace('{year}', targetYear)}</div>
            `;

            additionalPagesContainer.appendChild(pageDiv);

            // Generate calendar for this month
            setTimeout(() => {
                const calendarBody = document.getElementById(`calendar-body-${i}`);
                if (calendarBody) {
                    let currentDate = new Date(targetYear, targetMonth, 1);
                    currentDate.setDate(currentDate.getDate() - currentDate.getDay());

                    let weekRow = document.createElement('tr');

                    for (let j = 0; j < 42; j++) {
                        if (j > 0 && j % 7 === 0) {
                            calendarBody.appendChild(weekRow);
                            weekRow = document.createElement('tr');
                        }

                        const dayCell = document.createElement('td');
                        if (currentDate.getMonth() === targetMonth) {
                            dayCell.innerHTML = `
                                <div class="day-number">${currentDate.getDate()}</div>
                                <div class="day-content"></div>
                            `;
                        } else {
                            dayCell.classList.add('other-month');
                        }

                        weekRow.appendChild(dayCell);
                        currentDate.setDate(currentDate.getDate() + 1);
                    }

                    calendarBody.appendChild(weekRow);
                }
            }, 100);
        }
    </script>
</body>
</html>