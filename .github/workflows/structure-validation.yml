name: Structure Validation

on:
  pull_request:
    branches: [ "**" ]
  push:
    branches: [ "main", "master" ]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Validate repository structure
        shell: pwsh
        run: |
          $json = & ./.tools/validate-structure.ps1
          $result = $json | ConvertFrom-Json
          Write-Host "Compliance:" $result.compliance
          foreach($c in $result.checks){ Write-Host ($c | ConvertTo-Json -Compress) }
          if($result.compliance -lt 95){
            Write-Error "Compliance below threshold (95)."
          }
