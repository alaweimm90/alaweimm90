# Gitleaks Configuration File
# Auto-generated by Advanced Gitleaks Scanner v2.0.0
# https://github.com/gitleaks/gitleaks

title = "Gitleaks Enterprise Configuration"

# AWS Credentials
[[rules]]
id = "aws-access-key-id"
description = "AWS Access Key ID"
regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
tags = ["aws", "credentials", "critical"]

[[rules]]
id = "aws-secret-access-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z\/+]{40}['\"]'''
tags = ["aws", "credentials", "critical"]

[[rules]]
id = "aws-account-id"
description = "AWS Account ID"
regex = '''(?i)(aws_account_id|aws_account)(.{0,20})?['"][0-9]{12}['"]'''
tags = ["aws", "account"]

# GitHub Tokens
[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["github", "token", "critical"]

[[rules]]
id = "github-oauth"
description = "GitHub OAuth Access Token"
regex = '''gho_[0-9a-zA-Z]{36}'''
tags = ["github", "token", "critical"]

[[rules]]
id = "github-app-token"
description = "GitHub App Token"
regex = '''(ghu|ghs)_[0-9a-zA-Z]{36}'''
tags = ["github", "token", "critical"]

[[rules]]
id = "github-refresh-token"
description = "GitHub Refresh Token"
regex = '''ghr_[0-9a-zA-Z]{36}'''
tags = ["github", "token", "critical"]

# GitLab Tokens
[[rules]]
id = "gitlab-pat"
description = "GitLab Personal Access Token"
regex = '''glpat-[0-9a-zA-Z\-\_]{20}'''
tags = ["gitlab", "token", "high"]

[[rules]]
id = "gitlab-pipeline-token"
description = "GitLab Pipeline Trigger Token"
regex = '''glptt-[0-9a-f]{40}'''
tags = ["gitlab", "token", "high"]

[[rules]]
id = "gitlab-runner-token"
description = "GitLab Runner Registration Token"
regex = '''GR1348941[0-9a-zA-Z\-\_]{20}'''
tags = ["gitlab", "token", "high"]

# Slack Tokens
[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-([0-9a-zA-Z]{10,48})'''
tags = ["slack", "token", "high"]

[[rules]]
id = "slack-webhook"
description = "Slack Webhook URL"
regex = '''https://hooks\.slack\.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8,12}/[a-zA-Z0-9_]{24}'''
tags = ["slack", "webhook", "high"]

# Private Keys
[[rules]]
id = "private-key-rsa"
description = "RSA Private Key"
regex = '''-----BEGIN RSA PRIVATE KEY-----'''
tags = ["key", "private", "critical"]

[[rules]]
id = "private-key-dsa"
description = "DSA Private Key"
regex = '''-----BEGIN DSA PRIVATE KEY-----'''
tags = ["key", "private", "critical"]

[[rules]]
id = "private-key-ec"
description = "EC Private Key"
regex = '''-----BEGIN EC PRIVATE KEY-----'''
tags = ["key", "private", "critical"]

[[rules]]
id = "private-key-openssh"
description = "OpenSSH Private Key"
regex = '''-----BEGIN OPENSSH PRIVATE KEY-----'''
tags = ["key", "private", "critical"]

[[rules]]
id = "private-key-pgp"
description = "PGP Private Key"
regex = '''-----BEGIN PGP PRIVATE KEY BLOCK-----'''
tags = ["key", "private", "critical"]

# API Keys
[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?token)[\s]*[=:>][\s]*['\"]?[0-9a-zA-Z\-_]{32,}['\"]?'''
tags = ["api", "key", "high"]

[[rules]]
id = "generic-secret"
description = "Generic Secret"
regex = '''(?i)(secret|password|passwd|pwd|token)[\s]*[=:>][\s]*['\"]?[0-9a-zA-Z\-_!@#$%^&*()]{16,}['\"]?'''
tags = ["secret", "medium"]

# Database Connection Strings
[[rules]]
id = "password-in-url"
description = "Password in URL"
regex = '''[a-zA-Z]{3,10}://[^/\s:@]{3,20}:[^/\s:@]{3,20}@.{1,100}'''
tags = ["password", "url", "high"]

[[rules]]
id = "mongodb-connection"
description = "MongoDB Connection String"
regex = '''mongodb(\+srv)?://[^\s]+'''
tags = ["database", "connection", "high"]

[[rules]]
id = "mysql-connection"
description = "MySQL Connection String"
regex = '''mysql://[^\s]+'''
tags = ["database", "connection", "high"]

[[rules]]
id = "postgres-connection"
description = "PostgreSQL Connection String"
regex = '''(postgres|postgresql)://[^\s]+'''
tags = ["database", "connection", "high"]

[[rules]]
id = "sqlserver-connection"
description = "SQL Server Connection String"
regex = '''sqlserver://[^\s]+'''
tags = ["database", "connection", "high"]

# JWT Tokens
[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9-_=]+\.eyJ[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*'''
tags = ["jwt", "token", "medium"]

# Azure Credentials
[[rules]]
id = "azure-client-secret"
description = "Azure Client Secret"
regex = '''(?i)(client_secret|clientsecret)[\s]*[=:][\s]*['\"]?[0-9a-zA-Z\-_~.]{34,}['\"]?'''
tags = ["azure", "secret", "critical"]

[[rules]]
id = "azure-storage-key"
description = "Azure Storage Account Key"
regex = '''(?i)DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[^;]+;?'''
tags = ["azure", "storage", "critical"]

[[rules]]
id = "azure-connection-string"
description = "Azure Connection String"
regex = '''(?i)(azure|cosmosdb).*(?:AccountKey|SharedAccessKey)=[^;\"']+'''
tags = ["azure", "connection", "critical"]

# GCP Credentials
[[rules]]
id = "gcp-api-key"
description = "GCP API Key"
regex = '''AIza[0-9A-Za-z\-_]{35}'''
tags = ["gcp", "key", "critical"]

[[rules]]
id = "gcp-service-account"
description = "GCP Service Account Key"
regex = '''"type"\s*:\s*"service_account"'''
tags = ["gcp", "service-account", "critical"]

# Heroku
[[rules]]
id = "heroku-api-key"
description = "Heroku API Key"
regex = '''(?i)heroku(.{0,20})?['\"][0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}['\"]'''
tags = ["heroku", "key", "high"]

# Twilio
[[rules]]
id = "twilio-api-key"
description = "Twilio API Key"
regex = '''SK[0-9a-fA-F]{32}'''
tags = ["twilio", "key", "high"]

# SendGrid
[[rules]]
id = "sendgrid-api-key"
description = "SendGrid API Key"
regex = '''SG\.[0-9A-Za-z\-_]{22}\.[0-9A-Za-z\-_]{43}'''
tags = ["sendgrid", "key", "high"]

# Stripe
[[rules]]
id = "stripe-api-key"
description = "Stripe API Key"
regex = '''(?i)(sk|pk)_(test|live)_[0-9a-zA-Z]{24,}'''
tags = ["stripe", "key", "critical"]

# Mailgun
[[rules]]
id = "mailgun-api-key"
description = "Mailgun API Key"
regex = '''key-[0-9a-zA-Z]{32}'''
tags = ["mailgun", "key", "medium"]

# PayPal
[[rules]]
id = "paypal-token"
description = "PayPal Access Token"
regex = '''access_token\$production\$[0-9a-z]{16}\$[0-9a-f]{32}'''
tags = ["paypal", "token", "critical"]

# Square
[[rules]]
id = "square-access-token"
description = "Square Access Token"
regex = '''sq0atp-[0-9A-Za-z\-_]{22}'''
tags = ["square", "token", "high"]

[[rules]]
id = "square-oauth-secret"
description = "Square OAuth Secret"
regex = '''sq0csp-[0-9A-Za-z\-_]{43}'''
tags = ["square", "secret", "high"]

# NPM Tokens
[[rules]]
id = "npm-access-token"
description = "NPM Access Token"
regex = '''npm_[0-9a-zA-Z]{36}'''
tags = ["npm", "token", "high"]

# PyPI Token
[[rules]]
id = "pypi-token"
description = "PyPI Upload Token"
regex = '''pypi-AgEIcHlwaS5vcmc[0-9A-Za-z\-_]{50,}'''
tags = ["pypi", "token", "high"]

# Docker Hub
[[rules]]
id = "dockerhub-token"
description = "Docker Hub Access Token"
regex = '''(?i)dockerhub(.{0,20})?['\"][0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}['\"]'''
tags = ["docker", "token", "high"]

# SSH Keys in URLs
[[rules]]
id = "ssh-url-with-credentials"
description = "SSH URL with Credentials"
regex = '''ssh://[^@]+@[^:]+:[0-9]+'''
tags = ["ssh", "url", "medium"]

# Environment Variables
[[rules]]
id = "env-file-reference"
description = "Potential .env File Reference"
regex = '''(?i)(password|secret|key|token)[\s]*[=:]\s*['\"]?\$\{?[A-Z_]+\}?['\"]?'''
tags = ["env", "reference", "info"]

# IP Addresses with Credentials
[[rules]]
id = "ip-with-credentials"
description = "IP Address with Credentials"
regex = '''[a-zA-Z]+://[^:]+:[^@]+@\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'''
tags = ["ip", "credentials", "high"]

# Hardcoded Localhost Credentials
[[rules]]
id = "localhost-credentials"
description = "Hardcoded Localhost Credentials"
regex = '''[a-zA-Z]+://[^:]+:[^@]+@(localhost|127\.0\.0\.1)'''
tags = ["localhost", "credentials", "low"]

# Global Allowlist
[allowlist]
description = "Global allowlist for common false positives"

# Regex patterns to ignore
regexes = [
    # Test/Example/Demo values
    '''(example|sample|test|dummy|fake|mock|placeholder|template|todo|fixme)''',
    # Documentation
    '''(README|CHANGELOG|LICENSE|CONTRIBUTING)''',
    # Common placeholders
    '''(your-api-key-here|replace-with-your|insert-token-here)''',
    # Git commit hashes
    '''^[0-9a-f]{40}$''',
    # Package lock files
    '''integrity.*sha''',
    # Base64 encoded strings that are clearly not secrets
    '''iVBORw0KGgo''',  # PNG header
    # UUIDs without context
    '''^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$''',
]

# File paths to ignore
paths = [
    # Binary and media files
    '''(.*?)(jpg|jpeg|gif|png|bmp|svg|ico|pdf|zip|tar|gz|rar|7z|exe|dll|so|dylib|bin)$''',
    # Package manager files
    '''(go\.mod|go\.sum|package-lock\.json|yarn\.lock|Gemfile\.lock|Cargo\.lock|composer\.lock)$''',
    # Build artifacts
    '''(dist|build|out|target|bin|obj)/''',
    # Dependencies
    '''(node_modules|vendor|venv|\.venv|__pycache__)/''',
    # IDE and editor files
    '''(\.idea|\.vscode|\.vs)/''',
    # Test fixtures and mocks
    '''(test|tests|spec|specs|mock|mocks|fixture|fixtures)/.*\.(json|yaml|yml)$''',
    # Documentation
    '''(docs?|documentation)/''',
    # Git internals
    '''\.git/''',
]

# Commit SHA allowlist
[allowlist.commits]
description = "Allowlisted commits"
regexes = []

# Stopwords for reducing false positives
[allowlist.stopwords]
description = "Stopwords to reduce false positives"
stopwords = [
    "example",
    "test",
    "demo",
    "sample",
    "mock",
    "fake",
    "dummy",
    "placeholder",
    "template",
    "todo",
    "fixme",
    "changeme",
]
