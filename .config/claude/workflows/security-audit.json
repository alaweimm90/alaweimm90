{
  "id": "security-audit-workflow",
  "name": "Security Audit",
  "description": "Comprehensive security audit and vulnerability scanning",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "difficulty": "advanced",
  "estimatedTime": "30 minutes",
  "tags": ["security", "audit", "compliance", "scanning"],
  "steps": [
    {
      "id": "step-1",
      "name": "Dependency Vulnerability Scan",
      "description": "Scan npm/pnpm dependencies for known vulnerabilities",
      "type": "task",
      "action": "scan-dependencies",
      "agentId": "analysis-agent",
      "inputs": {
        "checkDevDependencies": true,
        "checkLock": true
      },
      "outputs": ["dependency-report"]
    },
    {
      "id": "step-2",
      "name": "Code Security Analysis",
      "description": "Run static security analysis on source code",
      "type": "task",
      "action": "security-scan",
      "agentId": "analysis-agent",
      "inputs": {
        "scanTypes": ["injection", "xss", "csrf", "sql-injection"],
        "severity": "high"
      },
      "outputs": ["security-report"]
    },
    {
      "id": "step-3",
      "name": "Dependency Licensing Review",
      "description": "Check for license compliance issues",
      "type": "task",
      "action": "license-check",
      "agentId": "analysis-agent",
      "inputs": {
        "allowedLicenses": ["MIT", "Apache-2.0", "BSD-2-Clause", "BSD-3-Clause"],
        "blockList": ["AGPL-3.0"]
      },
      "outputs": ["license-report"]
    },
    {
      "id": "step-4",
      "name": "Configuration Security Review",
      "description": "Review environment and configuration for security issues",
      "type": "task",
      "action": "config-review",
      "agentId": "analysis-agent",
      "inputs": {
        "checkSecrets": true,
        "checkDefaults": true
      },
      "outputs": ["config-report"]
    },
    {
      "id": "step-5",
      "name": "Generate Security Report",
      "description": "Compile findings into comprehensive report",
      "type": "task",
      "action": "generate-report",
      "agentId": "analysis-agent",
      "inputs": {
        "format": "markdown",
        "includeRecommendations": true
      },
      "outputs": ["security-audit-report"]
    }
  ]
}
