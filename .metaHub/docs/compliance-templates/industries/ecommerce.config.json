{
  "_metadata": {
    "version": "1.0.0",
    "industry": "E-commerce",
    "description": "E-commerce Industry Compliance Configuration Template",
    "frameworks": ["PCI_DSS", "GDPR", "CCPA"],
    "focus": "Payment security, EU/CA privacy rights, and consumer data protection",
    "lastUpdated": "2025-11-22",
    "productionReady": true,
    "frameworkAgnostic": true
  },
  "compliance": {
    "enabledFrameworks": ["PCI_DSS", "GDPR", "CCPA"],
    "strictMode": true,
    "auditLevel": "detailed",
    "dataHandling": {
      "encryptionRequired": true,
      "anonymizationRequired": true,
      "retentionLimits": {
        "cardholder_data": 2555,
        "personal_information": 2555,
        "consent_records": 2555,
        "transaction_data": 2555
      },
      "crossBorderTransferAllowed": true,
      "dataLocalizationRequired": true
    },
    "geographicCompliance": {
      "restrictedRegions": ["china", "russia"],
      "dataLocalizationRequired": true,
      "sovereigntyRequirements": {
        "europe": ["GDPR"],
        "north_america": ["CCPA"]
      }
    },
    "auditSettings": {
      "logRetention": 2555,
      "realTimeMonitoring": true,
      "alertOnViolation": true,
      "complianceReporting": true,
      "quarterlyScan": {
        "enabled": true,
        "automatedScheduling": true,
        "approvedScanner": true
      },
      "annualPrivacyReport": {
        "enabled": true,
        "automatedGeneration": true,
        "publicDisclosure": true
      },
      "dataBreachNotification": {
        "enabled": true,
        "timeframeHours": 72,
        "recipients": ["supervisory_authority", "data_subjects"],
        "automatedReporting": true
      }
    }
  },
  "dataClassification": {
    "cardholder_data": {
      "patterns": [
        "\\b\\d{13,19}\\b",
        "\\b\\d{3,4}\\b",
        "%[A-Z0-9]+\\?",
        "\\b\\d{1,2}/\\d{1,2}\\b"
      ],
      "riskLevel": "critical",
      "encryptionRequired": true,
      "maskingRequired": true,
      "accessLogging": true,
      "retentionDays": 2555,
      "pciCompliance": true,
      "gdprCompliance": true,
      "ccpaCompliance": true
    },
    "personal_information": {
      "patterns": [
        "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b",
        "\\b\\d{3}[-.]?\\d{3}[-.]?\\d{4}\\b",
        "\\b\\d{3}[-]\\d{2}[-]\\d{4}\\b",
        "\\b\\d{1,2}/\\d{1,2}/\\d{4}\\b",
        "\\b[A-Z][a-z]+ [A-Z][a-z]+\\b",
        "\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b"
      ],
      "riskLevel": "high",
      "encryptionRequired": true,
      "consentRequired": true,
      "accessLogging": true,
      "retentionDays": 2555,
      "pciCompliance": false,
      "gdprCompliance": true,
      "ccpaCompliance": true
    },
    "transaction_data": {
      "patterns": [
        "\\b(order|purchase|payment|transaction|invoice)\\b",
        "\\b(amount|total|price|cost)\\b"
      ],
      "riskLevel": "medium",
      "encryptionRequired": true,
      "accessLogging": true,
      "retentionDays": 2555,
      "pciCompliance": true,
      "gdprCompliance": true,
      "ccpaCompliance": true
    }
  },
  "routingRules": {
    "complianceFirstRouting": true,
    "dataClassificationRouting": true,
    "geographicComplianceRouting": true,
    "cardholderDataDetection": true,
    "consentValidationEnabled": true,
    "privacyRightsEnforced": true,
    "paymentSecurityEnforced": true
  },
  "geographicRestrictions": {
    "allowedRegions": ["north_america", "europe", "asia_pacific"],
    "blockedRegions": ["china", "russia"],
    "dataLocalization": {
      "personal_information": "europe",
      "cardholder_data": "north_america"
    },
    "crossBorderRules": {
      "adequacyDecision": true,
      "standardContractualClauses": true,
      "consentRequired": true
    }
  },
  "consentManagement": {
    "requiredForProcessing": true,
    "granularConsent": true,
    "optOutRights": true,
    "doNotSellRights": true,
    "consentRecords": {
      "retentionPeriod": 2555,
      "auditTrail": true,
      "automatedValidation": true
    },
    "lawfulBases": ["consent", "contract", "legitimate_interests"]
  },
  "privacyRights": {
    "rightToKnow": {
      "enabled": true,
      "responseTimeDays": 45,
      "automatedProcessing": true
    },
    "rightToDelete": {
      "enabled": true,
      "responseTimeDays": 45,
      "automatedProcessing": true
    },
    "rightToOptOut": {
      "enabled": true,
      "responseTimeDays": 15,
      "automatedProcessing": true
    },
    "rightToNonDiscrimination": {
      "enabled": true,
      "protectionEnabled": true
    },
    "rightToAccess": {
      "enabled": true,
      "responseTimeDays": 30,
      "automatedProcessing": true
    },
    "rightToRectification": {
      "enabled": true,
      "responseTimeDays": 30,
      "automatedProcessing": true
    }
  },
  "accessControls": {
    "roleBasedAccess": {
      "store_admin": {
        "cardholder_data": ["read"],
        "personal_information": ["read", "write"],
        "transaction_data": ["read", "write"]
      },
      "payment_processor": {
        "cardholder_data": ["read", "write"],
        "personal_information": [],
        "transaction_data": ["read", "write"]
      },
      "customer_service": {
        "cardholder_data": [],
        "personal_information": ["read"],
        "transaction_data": ["read", "write"]
      },
      "privacy_officer": {
        "cardholder_data": ["read"],
        "personal_information": ["read", "write", "delete"],
        "transaction_data": ["read"]
      }
    },
    "minimumAccessPrinciple": true,
    "accessLogging": true,
    "sessionTimeout": 1800,
    "twoPersonRule": true
  },
  "auditLogging": {
    "events": [
      "cardholder_data_access",
      "personal_data_access",
      "consent_granted",
      "consent_withdrawn",
      "opt_out_request",
      "privacy_right_exercised",
      "payment_transaction",
      "data_deletion",
      "authentication",
      "authorization_failure"
    ],
    "retentionPeriod": 2555,
    "tamperProof": true,
    "realTimeAlerts": true,
    "automatedReview": true
  },
  "breachDetection": {
    "cardholderDataPatterns": true,
    "personalDataExposure": true,
    "unauthorizedAccess": true,
    "notificationSettings": {
      "immediateAlert": true,
      "supervisoryAuthority": true,
      "dataSubjects": true,
      "timeframeHours": 72
    }
  },
  "encryption": {
    "requiredForCardholderData": true,
    "requiredForPersonalInfo": true,
    "algorithm": "AES-256",
    "keyRotationDays": 365,
    "dualControl": true,
    "envelopeEncryption": true
  },
  "monitoring": {
    "realTimeCompliance": true,
    "cardholderDataAlerts": true,
    "consentValidationAlerts": true,
    "privacyRightAlerts": true,
    "paymentSecurityAlerts": true,
    "dashboardEnabled": true,
    "reportingFrequency": "daily"
  },
  "integration": {
    "traeRouting": {
      "cardholderDataDetection": true,
      "consentValidation": true,
      "privacyRightsEnforcement": true,
      "auditIntegration": true
    },
    "externalSystems": {
      "payment_gateway": true,
      "consent_management": true,
      "privacy_portal": true,
      "tokenization_service": true,
      "audit_systems": true
    }
  },
  "validationRules": {
    "preFlightChecks": [
      "cardholder_data_detection",
      "personal_data_detection",
      "consent_validation",
      "geographic_compliance",
      "encryption_verification"
    ],
    "postProcessingValidation": [
      "audit_log_verification",
      "consent_compliance",
      "data_masking_check",
      "privacy_rights_processing",
      "retention_limits"
    ]
  },
  "_comments": {
    "compliance": "Combined PCI DSS, GDPR, and CCPA compliance settings",
    "dataClassification": "Cardholder data, personal information, and transaction data",
    "routingRules": "Multi-framework compliance-aware routing",
    "geographicRestrictions": "EU and CA data localization requirements",
    "consentManagement": "GDPR and CCPA consent management",
    "privacyRights": "GDPR and CCPA privacy rights implementation",
    "accessControls": "E-commerce role-based access with payment security",
    "auditLogging": "Comprehensive audit trail for all three frameworks",
    "breachDetection": "Multi-framework breach detection and notification",
    "encryption": "Strong encryption for payment and personal data",
    "monitoring": "Comprehensive compliance monitoring",
    "integration": "TRAE routing and e-commerce system integration",
    "validationRules": "Pre and post-processing compliance validation"
  }
}
