# Branch Protection Policy for Allstar
# Enforces branch protection requirements

# Enable this policy
enabled: true

# Action to take on violation
action: issue # Options: log, issue, fix

# Branch patterns to protect
protectBranches:
  - master
  - main
  - release/*

# Required protection rules
requirePullRequest: true
requiredApprovingReviewCount: 1

dismissStaleReviews: true
requireCodeOwnerReviews: true
requireLinearHistory: false
allowForcePushes: false
allowDeletions: false

# Required status checks
requireStatusChecks: true
requireUpToDateBranches: true

requiredStatusCheckContexts:
  - 'Super-Linter'
  - 'OpenSSF Scorecard'
  - 'OPA Policy Enforcement'
  - 'policy-bot'

# Admin enforcement
enforceAdmin: false # Allow admin to bypass in emergencies

# Restrictions
restrictions:
  users: []
  teams: []
  apps: []

# Issue template customization
issueTemplate: |
  Branch protection is not properly configured for this repository.

  **Required settings:**
  - Require pull request before merging
  - Require {{ .RequiredApprovingReviewCount }} approval(s)
  - Dismiss stale pull request approvals when new commits are pushed
  - Require review from Code Owners
  - Require status checks to pass before merging
  - Require branches to be up to date before merging
  - Block force pushes
  - Block deletions

  **Required status checks:**
  {{ range .RequiredStatusCheckContexts }}
  - {{ . }}
  {{ end }}

  Please configure branch protection at: {{ .RepoUrl }}/settings/branches
